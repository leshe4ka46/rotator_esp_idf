{"ast":null,"code":"import { bus } from '@/event-bus';\nexport default {\n  name: 'RotatorAuth',\n  data() {\n    return {\n      login_loading: false,\n      is_admin: 0,\n      // process.env.NODE_ENV === 'development',\n      login: null,\n      password: null,\n      err_input: 0\n    };\n  },\n  watch: {\n    is_admin(val) {\n      bus.$emit('is_admin', val ? 1 : 0);\n    }\n  },\n  methods: {\n    send() {\n      if (length(this.login) == 0 || length(this.password) == 0) {\n        this.err_input = 1;\n        alert(this.err_input);\n        return -1;\n      }\n      this.err_input = 0;\n      this.login_loading = true;\n      // eslint-disable-next-line\n      //console.log(this.color_data);\n      this.$ajax.post('/api/v1/users/auth', {\n        login: this.login,\n        password: this.password,\n        key: localStorage.getItem('rotator_client_id')\n      }).then(data => {\n        // eslint-disable-next-line\n        console.log(data);\n        if (data.data.role === 'admin') {\n          this.is_admin = 1;\n          bus.$emit('is_admin', 1);\n          bus.$emit('close_dialogs');\n        }\n        this.login_loading = false;\n      }).catch(error => {\n        // eslint-disable-next-line\n        console.log(error);\n      });\n    },\n    checkadmin() {\n      if (localStorage.getItem('rotator_client_id') != null) {\n        this.$ajax.post('/api/v1/users/whoami', {\n          key: localStorage.getItem('rotator_client_id')\n        }).then(function (data) {\n          // eslint-disable-next-line\n          console.log(data);\n          if (data.data.role == \"admin\") {\n            this.is_admin = 1;\n            bus.$emit('is_admin', 1);\n            bus.$emit('close_dialogs');\n          }\n        }).catch(error => {\n          // eslint-disable-next-line\n          console.log(error);\n        });\n      }\n    }\n  },\n  created() {\n    this.checkadmin();\n    bus.$emit('is_admin', this.is_admin ? 1 : 0);\n    bus.$on('get_admin', () => {\n      bus.$emit('is_admin', this.is_admin ? 1 : 0);\n    });\n  }\n};","map":{"version":3,"mappings":"AAyCA;AACA;EACAA;EACAC;IACA;MACAC;MACAC;MAAA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAJ;MACAK;IACA;EACA;EACAC;IACAC;MACA;QACA;QACAC;QAEA;MACA;MACA;MACA;MACA;MACA;MACA,WACAC;QACAR;QACAC;QACAQ;MACA,GACAC;QACA;QACAC;QACA;UACA;UACAP;UACAA;QAEA;QACA;MACA,GACAQ;QAAA;QACAD;MACA;IACA;IACAE;MACA;QACA,WACAL;UACAC;QACA,GACAC;UACA;UACAC;UACA;YACA;YACAP;YACAA;UAEA;QACA,GACAQ;UAAA;UACAD;QACA;MACA;IACA;EACA;EACAG;IACA;IACAV;IACAA;MACAA;IACA;EACA;AACA","names":["name","data","login_loading","is_admin","login","password","err_input","watch","bus","methods","send","alert","post","key","then","console","catch","checkadmin","created"],"sourceRoot":"src/components","sources":["RotatorAuth.vue"],"sourcesContent":["<template>\n  <!--<div class=\"card has-text-left\">\n    <div class=\"card-content\" v-if=\"auth_needed\">\n      <b-field label=\"Username\" :type=\"isLoginLabelDanger\">\n        <b-input value=\"\" maxlength=\"30\" v-model=\"login\"></b-input>\n      </b-field>\n\n      <b-field label=\"Password\" :type=\"isPassLabelDanger\">\n        <b-input type=\"password\" value=\"\" v-model=\"password\" password-reveal>\n        </b-input>\n      </b-field>\n      <b-field>\n        <b-button label=\"Auth\" type=\"is-info\" @click=\"send\" />\n      </b-field>\n\n    </div>\n  </div>-->\n\n  <div class=\"d-flex justify-center\">\n    <v-card flat max-width=\"500px\">\n      <v-card-title primary-title>\n        <h4>Login</h4>\n      </v-card-title>\n      <div class=\"container\">\n        <v-form>\n          <v-text-field name=\"Username\" label=\"Username\" v-model=\"login\" :error=\"err_input\"\n            :rules=\"[() => !!login || 'Тут нужно что-то написать']\" required></v-text-field>\n          <v-text-field name=\"Password\" label=\"Password\" type=\"password\" v-model=\"password\" :error=\"err_input\"\n            :rules=\"[() => !!password || 'Тут нужно что-то написать']\" required>\n          </v-text-field>\n          <v-card-actions>\n            <v-btn primary large block @click=\"send\" :loading=\"login_loading\">Login</v-btn>\n          </v-card-actions>\n        </v-form>\n      </div>\n    </v-card>\n  </div>\n\n</template>\n\n<script>\nimport { bus } from '@/event-bus'\nexport default {\n  name: 'RotatorAuth',\n  data() {\n    return {\n      login_loading: false,\n      is_admin: 0, // process.env.NODE_ENV === 'development',\n      login: null,\n      password: null,\n      err_input:0\n    }\n  },\n  watch: {\n    is_admin(val) {\n      bus.$emit('is_admin', val ? 1 : 0)\n    }\n  },\n  methods: {\n    send() {\n      if (length(this.login) == 0 || length(this.password) == 0) {\n        this.err_input=1;\n        alert(this.err_input);\n\n        return -1;\n      }\n      this.err_input=0;\n      this.login_loading = true\n      // eslint-disable-next-line\n      //console.log(this.color_data);\n      this.$ajax\n        .post('/api/v1/users/auth', {\n          login: this.login,\n          password: this.password,\n          key: localStorage.getItem('rotator_client_id')\n        })\n        .then(data => {\n          // eslint-disable-next-line\n          console.log(data);\n          if (data.data.role === 'admin') {\n            this.is_admin = 1;\n            bus.$emit('is_admin', 1)\n            bus.$emit('close_dialogs')\n\n          }\n          this.login_loading = false\n        })\n        .catch(error => { // eslint-disable-next-line\n          console.log(error);\n        })\n    },\n    checkadmin() {\n      if (localStorage.getItem('rotator_client_id') != null) {\n        this.$ajax\n          .post('/api/v1/users/whoami', {\n            key: localStorage.getItem('rotator_client_id')\n          })\n          .then(function (data) {\n            // eslint-disable-next-line\n            console.log(data);\n            if (data.data.role == \"admin\") {\n              this.is_admin = 1;\n              bus.$emit('is_admin', 1)\n              bus.$emit('close_dialogs')\n\n            }\n          })\n          .catch(error => { // eslint-disable-next-line\n            console.log(error);\n          })\n      }\n    }\n  },\n  created() {\n    this.checkadmin()\n    bus.$emit('is_admin', this.is_admin ? 1 : 0)\n    bus.$on('get_admin', () => {\n      bus.$emit('is_admin', this.is_admin ? 1 : 0)\n    })\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n\n</style>\n"]},"metadata":{},"sourceType":"module"}
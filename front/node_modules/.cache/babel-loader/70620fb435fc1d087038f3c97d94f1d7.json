{"ast":null,"code":"import { bus } from '@/event-bus';\nexport default {\n  name: 'RotatorAuth',\n  data() {\n    return {\n      login_loading: false,\n      is_admin: 0,\n      // process.env.NODE_ENV === 'development',\n      login: null,\n      password: null\n    };\n  },\n  watch: {\n    is_admin(val) {\n      bus.$emit('is_admin', val ? 1 : 0);\n    }\n  },\n  methods: {\n    send() {\n      this.login_loading = true;\n      // eslint-disable-next-line\n      //console.log(this.color_data);\n      this.$ajax.post('/api/v1/users/auth', {\n        login: this.login,\n        password: this.password,\n        key: localStorage.getItem('rotator_client_id')\n      }).then(data => {\n        // eslint-disable-next-line\n        console.log(data);\n        if (data.data.role === 'admin') {\n          this.is_admin = 1;\n          bus.$emit('close_dialogs');\n        }\n        this.login_loading = false;\n      }).catch(error => {\n        // eslint-disable-next-line\n        console.log(error);\n      });\n      //setTimeout(() => { this.checkadmin() }, 2000)\n    },\n\n    checkadmin() {\n      /*\n      try {\n        axios.get('api/whoami?key=' + localStorage.getItem('rotator_client_id')).then((response) => {\n          this.is_admin = response.data === 'ADMIN' ? 1 : 0\n        })\n      } catch (e) { // eslint-disable-next-line\n        console.log(e);\n      }\n       if (this.is_admin) bus.$emit('close_dialogs') */\n      this.login_loading = false;\n      this.is_admin = 1;\n    }\n  },\n  created() {\n    this.checkadmin();\n    bus.$emit('is_admin', this.is_admin ? 1 : 0);\n    bus.$on('get_admin', () => {\n      bus.$emit('is_admin', this.is_admin ? 1 : 0);\n    });\n  }\n};","map":null,"metadata":{},"sourceType":"module"}